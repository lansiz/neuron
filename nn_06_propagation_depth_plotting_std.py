from __future__ import print_function
import numpy as np
import multiprocessing
from nn import NeuralNetwork
from gene import Gene
import strengthen_functions
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

def factory(a):
    def pf(x):
        return (np.exp(a * x) / (1 + np.exp(a * x)) - .5) * 1.8 + .05
    return pf

mean1= [0.05248333333333333, 0.05281333333333333, 0.055496666666666666, 0.05749666666666667, 0.05856666666666667, 0.05887, 0.061386666666666666, 0.06408333333333334, 0.06745666666666666, 0.06734666666666667, 0.06908, 0.07208666666666666, 0.07457333333333334, 0.07882333333333333, 0.07754333333333334, 0.08223333333333334, 0.08312, 0.08817, 0.08911333333333334, 0.09541333333333334]
std1= [0.234624877316016, 0.2360594949489547, 0.24118482537027264, 0.2451886348417389, 0.24756806247081944, 0.24782585908926724, 0.25431937366669927, 0.25845049762424954, 0.2651281415760227, 0.26364956505853665, 0.26790785779194054, 0.2737215966797083, 0.2776907475752278, 0.28427137642674394, 0.28225939273811407, 0.2910630153229518, 0.2921604563705819, 0.3001378312820073, 0.30136159978043353, 0.31049900024888255]
mean3= [0.052803333333333334, 0.055606666666666665, 0.06269666666666666, 0.06669333333333333, 0.07882333333333333, 0.08084333333333334, 0.09162666666666666, 0.10302333333333333, 0.12611, 0.15746, 0.17408666666666667, 0.23854666666666666, 0.3086933333333333, 0.43023333333333336, 0.5483433333333333, 0.6853066666666666, 0.79632, 0.9976266666666667, 1.1691766666666668, 1.3842966666666667]
std3= [0.23561651326301863, 0.24171863523986362, 0.2553803594423206, 0.2634995242669119, 0.2841892833814971, 0.28873463385761133, 0.3055124993987789, 0.32176004432219707, 0.35326987025973966, 0.38861250846226425, 0.40558661116407135, 0.4600458178148008, 0.5055509462842385, 0.5586047608899238, 0.5982665978660537, 0.629868853510175, 0.670090385147158, 0.7582486623499941, 0.8312696647030708, 0.8945125704290328]
mean11= [0.05189, 0.07196333333333334, 0.09884, 0.23896666666666666, 0.63277, 1.2721533333333332, 2.1299633333333334, 3.0130666666666666, 3.9402666666666666, 5.084603333333333, 5.849783333333333, 6.61784, 7.31566, 7.6222, 8.448833333333333, 8.8592, 9.012173333333333, 9.696866666666667, 9.784773333333334, 9.947323333333333]
std11= [0.23424508795988302, 0.27315065194056476, 0.3170551808965331, 0.45974079532807277, 0.6081272841820755, 0.8424167000296758, 1.193021178348854, 1.5256679178496075, 1.8918347167645366, 2.39613277511679, 2.7401554006519815, 3.1047781028172268, 3.4855719900374074, 3.638543732502515, 4.200451797789798, 4.484040814562983, 4.551598086748091, 5.103894282691296, 5.150687088336425, 5.293180691744384]
mean5= [0.05212666666666667, 0.06093333333333333, 0.06721, 0.08015333333333333, 0.09875, 0.11853333333333334, 0.18156333333333333, 0.2917, 0.46853333333333336, 0.67866, 0.8862766666666667, 1.2600066666666667, 1.5659733333333334, 1.9570366666666668, 2.3505766666666665, 2.849336666666667, 3.30722, 3.6757733333333333, 4.21866, 4.717233333333334]
std5= [0.23394332067594684, 0.2519929805018826, 0.26360225574401547, 0.2863484645594517, 0.3159194583539714, 0.3441266950154001, 0.41218695918505505, 0.49649213823920046, 0.5776185438697603, 0.6268444286530218, 0.7000121452200352, 0.8540393433300103, 0.9613709928823292, 1.1326918462916362, 1.2787178477374208, 1.4583017154629634, 1.6525583817019396, 1.7838508164330584, 2.025920647771444, 2.272868161352279]
mean15= [0.05290333333333333, 0.08069, 0.19353666666666666, 0.6762733333333333, 1.5844266666666666, 2.7468433333333335, 4.26066, 5.611603333333333, 6.323573333333333, 7.426423333333333, 8.05433, 8.78093, 9.30252, 9.42401, 9.99978, 10.113323333333334, 10.772383333333334, 10.667013333333333, 11.13334, 11.223733333333334]
std15= [0.23582034967793222, 0.2883847960046901, 0.42266640745260187, 0.6367058807818742, 0.9694837825473009, 1.4207304584105866, 2.0466874939114015, 2.617450036961334, 2.913274268691883, 3.546821084782196, 3.897442526978429, 4.417763197414879, 4.806916716177498, 4.855983132854424, 5.294188003675982, 5.405632354818033, 5.974753606054023, 5.882757846437521, 6.330268591805565, 6.4109039972707595]
mean7= [0.051796666666666664, 0.06535666666666666, 0.07429, 0.09490666666666667, 0.16212666666666667, 0.29618333333333335, 0.5492366666666667, 0.8793566666666667, 1.27946, 1.76604, 2.339863333333333, 2.971276666666667, 3.6210533333333332, 4.20735, 4.930223333333333, 5.45199, 5.92267, 6.439996666666667, 6.92094, 7.254983333333334]
std7= [0.23306745516170968, 0.2619767918262142, 0.2767989569464933, 0.3104073527193295, 0.392260471229117, 0.4980148254709782, 0.5940839592646443, 0.696947046856662, 0.8552711704872711, 1.0395396665832428, 1.2537688176011113, 1.521533755827396, 1.764563994444205, 1.9976058947733741, 2.322709886487955, 2.5595224241838554, 2.7383906595723944, 3.0283350100875928, 3.2733911340382167, 3.426064822268967]
mean19= [0.053086666666666664, 0.09021, 0.4390966666666667, 1.3493866666666667, 2.97861, 4.617663333333334, 6.086366666666667, 7.2541633333333335, 8.1952, 9.088556666666667, 9.43749, 9.97827, 10.358463333333333, 10.594046666666667, 10.848836666666667, 11.18256, 11.43015, 11.66746, 11.68062, 12.136733333333334]
std19= [0.23678782166506976, 0.30428959216509527, 0.5640603844644846, 0.8802474787366461, 1.4654916585342046, 2.137506804664932, 2.8505076972746837, 3.4307352467542898, 4.010253976994475, 4.62976252632057, 4.891639040229768, 5.305737567994984, 5.6269779371632715, 5.828647232233413, 6.0639607227170895, 6.358666409953164, 6.607197664479247, 6.829996374942912, 6.850344741855453, 7.3189337107410815]
mean9= [0.052436666666666666, 0.06845, 0.09533, 0.15388666666666667, 0.29777333333333333, 0.68887, 1.18784, 1.7222266666666666, 2.591693333333333, 3.5300366666666667, 4.202683333333334, 5.03892, 5.489556666666667, 6.469233333333333, 6.81874, 7.39488, 7.954093333333334, 8.17351, 8.62648, 9.12125]
std9= [0.2352595644294947, 0.2668169113206033, 0.3118154225927041, 0.3851305758945774, 0.5033729981722191, 0.6292228988469295, 0.8438618376645945, 1.029431222547459, 1.3593867487298168, 1.7563915087442463, 2.0412584679690995, 2.3613834716679682, 2.5171871080213504, 3.0389548771832, 3.157463878769373, 3.5005232635897925, 3.870062778727096, 3.982648735021288, 4.292962008869867, 4.664739553733591]
mean13= [0.05246, 0.07177333333333333, 0.14542333333333332, 0.4365466666666667, 1.065, 1.9264933333333334, 2.9363133333333336, 4.26156, 5.471986666666667, 6.27626, 6.914126666666666, 7.910153333333334, 8.512966666666667, 8.562806666666667, 9.167963333333333, 9.742386666666667, 9.824553333333334, 10.12406, 10.45847, 10.58275]
std13= [0.23467981393095289, 0.2726204723705752, 0.37525376407913025, 0.5645709354505911, 0.7880831174438391, 1.106295667210574, 1.5205955001760185, 2.0733611278308466, 2.55675091730805, 2.9113079098118995, 3.2218492263432954, 3.8326693365271622, 4.251561893260196, 4.217508979159249, 4.632138993163837, 5.133572703665765, 5.1580246671720715, 5.416993241925511, 5.726022056579361, 5.814285204347995]
mean17= [0.05312, 0.08299333333333334, 0.21351, 1.0405866666666668, 2.07734, 3.7853, 5.194913333333333, 6.489773333333333, 7.506353333333333, 7.996896666666666, 8.767436666666667, 9.304753333333334, 10.028436666666666, 10.51746, 10.44703, 10.95374, 11.134113333333334, 11.453836666666668, 11.486996666666666, 11.825206666666666]
std17= [0.23676626786770114, 0.2922649025950411, 0.4414258864558504, 0.7755982996944286, 1.1508367351916893, 1.8943258897736333, 2.3991572393562612, 3.073351387105325, 3.578105593069544, 3.838151512901607, 4.3659589587308565, 4.765893278196184, 5.365362493748417, 5.8004478403309525, 5.696486125595322, 6.157908195624009, 6.290621613202378, 6.644832750339837, 6.686122761360943, 7.0097004660652615]
mean21= [0.05226666666666667, 0.10766, 0.5037766666666667, 1.83547, 3.57951, 5.448203333333334, 6.873043333333333, 7.8541533333333335, 9.047036666666667, 9.389086666666667, 10.258556666666667, 10.41625, 10.836943333333334, 11.02765, 11.359243333333334, 11.576, 11.862046666666666, 11.978026666666667, 12.22086, 12.149093333333333]
std21= [0.23446718794369126, 0.32821130043515157, 0.5837742744036908, 1.0782701636262904, 1.856745762501336, 2.5827202272001686, 3.2515942763700125, 3.7818269945211513, 4.633423236152965, 4.831349524976318, 5.560920048288373, 5.683361030602109, 6.044580701486985, 6.218151290978694, 6.536348692309457, 6.765982855432016, 7.062808851853646, 7.170281991615733, 7.406681276190212, 7.363333790565854]

'''
fig, ax = plt.subplots(1, 1, figsize=(9, 2))
# for ax in axes:
# ax2.tick_params(labelsize=8)
# ax3.tick_params(labelsize=8)
'''
import utils
z_data = utils.read_pickle('nn_06_propagation_depth_4.pkl')

f = plt.figure(figsize=(8, 3))
gs = gridspec.GridSpec(2, 2, width_ratios=[1, 1], height_ratios=[1, 1])
ax1 = plt.subplot(gs[0, 0])
ax2 = plt.subplot(gs[0, 1])
ax3 = plt.subplot(gs[1, 0])
ax4 = plt.subplot(gs[1, 1])

xs1 = np.linspace(0, 1, 100)
xs2 = np.linspace(0, 1, 20)
# marker_style = dict(color='cornflowerblue', markersize=3)
for pf, ys2, ys3 in zip(
    [factory(1), factory(3), factory(5), factory(9), factory(13), factory(17), factory(21)],
    [mean1, mean3, mean5, mean9, mean13, mean17, mean21],
    [std1, std3, std5, std9, std13, std17, std21]):
    ys1 = [pf(x) for x in xs1]
    ax1.plot(xs1, ys1)
    ax3.plot(xs2, ys2, marker='s', markersize=3)
    ax4.plot(xs2, ys3, marker='s', markersize=3)
    ax2.hist(z_data, bins=z_data.max())
    ax1.tick_params(labelsize=8)
    ax2.tick_params(labelsize=8)
    ax3.tick_params(labelsize=8)
    ax4.tick_params(labelsize=8)
plt.show()


# ax.set_ylim(0, 1)
plt.savefig('nn_06.png')
