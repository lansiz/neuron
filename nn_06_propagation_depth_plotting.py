from __future__ import print_function
import numpy as np
import multiprocessing
from nn import NeuralNetwork
from gene import Gene
import strengthen_functions
import matplotlib.pyplot as plt

def factory(a):
    def pf(x):
        return (np.exp(a * x) / (1 + np.exp(a * x)) - .5) * 1.8 + .05
    return pf
'''
y11 = [0.0524, 0.0673, 0.0951, 0.2459, 0.637, 1.2921, 2.0124, 2.994, 3.9824, 5.0251, 5.798, 6.5728, 7.2304, 7.6479, 8.372, 8.6833, 9.2205, 9.6308, 9.6468, 9.9971]
y15 = [0.0522, 0.0708, 0.1717, 0.6175, 1.6276, 2.7986, 4.2406, 5.7087, 6.9373, 7.467, 8.0017, 8.695, 9.1579, 9.3662, 10.2561, 10.3109, 10.529, 10.8679, 11.1166, 10.904]
y13 = [0.0556, 0.0781, 0.1167, 0.4685, 1.0425, 1.9768, 3.138, 4.1554, 5.5015, 6.2057, 7.254, 7.9441, 8.3011, 8.687, 9.2709, 9.6533, 9.7715, 10.315, 10.1101, 10.3045]
y3 = [0.0502, 0.0554, 0.0606, 0.0621, 0.0758, 0.0874, 0.0859, 0.1055, 0.1224, 0.1565, 0.1806, 0.218, 0.3241, 0.4497, 0.5814, 0.665, 0.8084, 0.9727, 1.1979, 1.367]
y1 = [0.0543, 0.0538, 0.055, 0.0575, 0.0622, 0.059, 0.0591, 0.0661, 0.0678, 0.0694, 0.066, 0.0659, 0.0717, 0.0803, 0.0747, 0.0837, 0.0874, 0.0906, 0.1, 0.0932]
y5 = [0.0513, 0.0589, 0.0651, 0.0856, 0.1013, 0.1187, 0.1774, 0.3161, 0.479, 0.6865, 0.8878, 1.2424, 1.5963, 1.9797, 2.3387, 2.808, 3.3532, 3.7496, 4.2501, 4.6845]
y19 = [0.0504, 0.1052, 0.4637, 1.3951, 2.7971, 4.6896, 6.1891, 7.468, 8.0947, 9.2506, 9.5436, 10.2677, 10.4647, 10.6217, 11.1511, 11.1697, 11.8343, 11.6775, 11.9053, 12.0546]
y17 = [0.0528, 0.0944, 0.2579, 0.9805, 2.3014, 3.7567, 5.4472, 6.5463, 7.5769, 8.1879, 8.7089, 9.1949, 9.7939, 10.3465, 10.3753, 10.6997, 11.1959, 11.2035, 11.5535, 11.7127]
y21 = [0.0532, 0.1012, 0.4957, 1.7678, 3.7176, 5.5043, 6.8917, 8.0959, 8.8661, 9.4547, 9.7352, 10.431, 10.9273, 11.0559, 11.0955, 11.3642, 11.9128, 12.3375, 12.2209, 12.4687]
y9 = [0.0506, 0.0652, 0.1052, 0.1388, 0.3041, 0.7055, 1.1777, 1.7644, 2.6116, 3.3069, 4.2059, 4.9748, 5.6712, 6.4624, 6.9577, 7.5083, 7.7031, 8.0744, 8.5456, 8.8608]
y7 = [0.0517, 0.0615, 0.0789, 0.1044, 0.152, 0.253, 0.555, 0.8514, 1.2831, 1.7612, 2.4172, 2.9653, 3.6691, 4.2347, 4.8769, 5.523, 6.1176, 6.4523, 6.7123, 7.297]
'''


'''
y1 = [0.05298, 0.05394, 0.05614, 0.05788, 0.06014, 0.0611, 0.06158, 0.06326, 0.06424, 0.06692, 0.06936, 0.0686, 0.0724, 0.07614, 0.08152, 0.0813, 0.08538, 0.09198, 0.09316, 0.09184]
y3 = [0.05198, 0.05748, 0.06058, 0.06654, 0.07376, 0.07782, 0.09022, 0.1013, 0.13218, 0.14196, 0.1755, 0.23878, 0.32254, 0.43368, 0.5696, 0.70536, 0.80654, 0.97978, 1.1934, 1.3828]
y9 = [0.05224, 0.06388, 0.08872, 0.1368, 0.29682, 0.70368, 1.20974, 1.7611, 2.54924, 3.33266, 4.20556, 4.98, 5.54206, 6.34028, 6.66988, 7.24524, 7.87674, 8.10378, 8.62278, 8.90746]
y5 = [0.0508, 0.05752, 0.06994, 0.0793, 0.09984, 0.12548, 0.17772, 0.27536, 0.48362, 0.68776, 0.88502, 1.2559, 1.55136, 1.91398, 2.3472, 2.81008, 3.34166, 3.69172, 4.1506, 4.661]
y7 = [0.05314, 0.0629, 0.07824, 0.10152, 0.15934, 0.27172, 0.60254, 0.85618, 1.32968, 1.82916, 2.32536, 2.90904, 3.57968, 4.32522, 4.92052, 5.48946, 6.00162, 6.4657, 6.8354, 7.19696]
y11 = [0.05368, 0.07218, 0.11356, 0.2053, 0.6616, 1.23418, 1.97612, 3.13438, 3.87358, 4.95614, 5.73312, 6.86838, 7.26434, 7.59902, 8.23722, 8.73564, 9.05944, 9.4076, 9.65872, 9.89168]
y13 = [0.05066, 0.08128, 0.12048, 0.4235, 1.03512, 1.88186, 3.14124, 4.42034, 5.30312, 6.29112, 7.26682, 7.76294, 8.44528, 8.92814, 9.2581, 9.53996, 10.00742, 10.27086, 10.58044, 10.61524]
y15 = [0.05466, 0.07526, 0.18218, 0.67962, 1.55566, 2.68922, 4.25694, 5.34556, 6.34506, 7.34464, 8.126, 8.75212, 9.12966, 9.56554, 9.94988, 10.18262, 10.43196, 10.63138, 11.01496, 11.36764]
y19 = [0.0521, 0.10054, 0.35114, 1.42564, 2.99638, 4.4551, 5.98478, 7.3508, 8.0364, 8.86548, 9.41738, 10.10368, 10.42716, 10.5687, 10.97622, 11.2232, 11.53242, 11.74438, 12.02846, 12.21944]
y17 = [0.05328, 0.07404, 0.28306, 0.98434, 2.22516, 3.5945, 5.47878, 6.58222, 7.3901, 8.10524, 8.88484, 9.40832, 9.81072, 10.21008, 10.75704, 10.77216, 10.8912, 11.49528, 11.50636, 11.58686]
y21 = [0.05402, 0.09068, 0.56312, 1.86226, 3.64316, 5.39836, 6.717, 8.0591, 8.82546, 9.26566, 10.03158, 10.63344, 10.68384, 11.0362, 11.49552, 11.67684, 11.9335, 11.9824, 12.34906, 12.25104]
'''
'''
y3 = [0.05221, 0.05612, 0.06064, 0.0663, 0.07113, 0.0823, 0.0894, 0.10083, 0.12616, 0.14831, 0.19072, 0.25324, 0.31062, 0.42126, 0.55444, 0.68054, 0.8367, 0.98899, 1.17688, 1.35211]
y9 = [0.05343, 0.06748, 0.10368, 0.16119, 0.28711, 0.64867, 1.09876, 1.8034, 2.50136, 3.35719, 4.21442, 4.95366, 5.74705, 6.23758, 6.78664, 7.32241, 7.85847, 8.25718, 8.64752, 8.73622]
y1 = [0.05286, 0.0551, 0.05518, 0.05723, 0.05663, 0.05856, 0.06219, 0.0643, 0.06386, 0.06362, 0.07002, 0.07327, 0.07222, 0.07873, 0.08073, 0.08082, 0.08761, 0.08794, 0.09177, 0.0953]
y11 = [0.05312, 0.0771, 0.1083, 0.23314, 0.63078, 1.26274, 2.07809, 2.90561, 4.00505, 4.9753, 5.74527, 6.82937, 7.47906, 7.93855, 8.23022, 8.64423, 9.17662, 9.20011, 9.75497, 9.79616]
y7 = [0.05301, 0.0614, 0.08987, 0.10534, 0.16621, 0.27614, 0.55154, 0.84959, 1.37887, 1.79984, 2.33888, 3.01862, 3.60404, 4.36435, 4.97065, 5.57679, 5.97839, 6.37551, 6.86276, 7.34941]
y17 = [0.0526, 0.08274, 0.26504, 1.02289, 2.15665, 3.71654, 5.30192, 6.38777, 7.57458, 8.19364, 8.99368, 9.36771, 9.76174, 10.30788, 10.58239, 10.86204, 11.13169, 11.02958, 11.68627, 11.60806]
y13 = [0.05312, 0.08693, 0.13891, 0.48314, 1.02092, 1.88579, 3.0587, 4.28147, 5.33461, 6.25279, 7.11875, 7.91291, 8.20294, 8.64905, 9.26755, 9.65708, 9.91778, 10.22628, 10.49981, 11.08829]
y19 = [0.05235, 0.10061, 0.34816, 1.29459, 2.84807, 4.68728, 6.21674, 7.35083, 8.15206, 8.90508, 9.57116, 9.69292, 10.17726, 10.69927, 10.99394, 11.37785, 11.56583, 11.5712, 11.85278, 12.24135]
y5 = [0.05306, 0.05999, 0.06847, 0.07982, 0.09849, 0.12935, 0.16308, 0.27349, 0.47216, 0.68899, 0.91544, 1.25626, 1.58518, 1.96308, 2.3534, 2.81068, 3.27788, 3.65609, 4.24195, 4.61566]
y21 = [0.05248, 0.09228, 0.57305, 1.78576, 3.72571, 5.48168, 6.95647, 8.05147, 8.87221, 9.47474, 9.68926, 10.49345, 10.7141, 10.94652, 11.22928, 11.82804, 11.66785, 11.89913, 12.08276, 12.56942]
y15 = [0.05255, 0.0775, 0.18725, 0.71755, 1.57306, 2.86822, 4.21651, 5.64937, 6.51639, 7.29212, 7.94907, 8.53843, 9.25604, 9.62229, 10.20485, 10.57335, 10.66651, 10.79138, 10.77703, 11.26915]
'''

mean1= [0.05248333333333333, 0.05281333333333333, 0.055496666666666666, 0.05749666666666667, 0.05856666666666667, 0.05887, 0.061386666666666666, 0.06408333333333334, 0.06745666666666666, 0.06734666666666667, 0.06908, 0.07208666666666666, 0.07457333333333334, 0.07882333333333333, 0.07754333333333334, 0.08223333333333334, 0.08312, 0.08817, 0.08911333333333334, 0.09541333333333334]
std1= [0.234624877316016, 0.2360594949489547, 0.24118482537027264, 0.2451886348417389, 0.24756806247081944, 0.24782585908926724, 0.25431937366669927, 0.25845049762424954, 0.2651281415760227, 0.26364956505853665, 0.26790785779194054, 0.2737215966797083, 0.2776907475752278, 0.28427137642674394, 0.28225939273811407, 0.2910630153229518, 0.2921604563705819, 0.3001378312820073, 0.30136159978043353, 0.31049900024888255]
mean3= [0.052803333333333334, 0.055606666666666665, 0.06269666666666666, 0.06669333333333333, 0.07882333333333333, 0.08084333333333334, 0.09162666666666666, 0.10302333333333333, 0.12611, 0.15746, 0.17408666666666667, 0.23854666666666666, 0.3086933333333333, 0.43023333333333336, 0.5483433333333333, 0.6853066666666666, 0.79632, 0.9976266666666667, 1.1691766666666668, 1.3842966666666667]
std3= [0.23561651326301863, 0.24171863523986362, 0.2553803594423206, 0.2634995242669119, 0.2841892833814971, 0.28873463385761133, 0.3055124993987789, 0.32176004432219707, 0.35326987025973966, 0.38861250846226425, 0.40558661116407135, 0.4600458178148008, 0.5055509462842385, 0.5586047608899238, 0.5982665978660537, 0.629868853510175, 0.670090385147158, 0.7582486623499941, 0.8312696647030708, 0.8945125704290328]
mean11= [0.05189, 0.07196333333333334, 0.09884, 0.23896666666666666, 0.63277, 1.2721533333333332, 2.1299633333333334, 3.0130666666666666, 3.9402666666666666, 5.084603333333333, 5.849783333333333, 6.61784, 7.31566, 7.6222, 8.448833333333333, 8.8592, 9.012173333333333, 9.696866666666667, 9.784773333333334, 9.947323333333333]
std11= [0.23424508795988302, 0.27315065194056476, 0.3170551808965331, 0.45974079532807277, 0.6081272841820755, 0.8424167000296758, 1.193021178348854, 1.5256679178496075, 1.8918347167645366, 2.39613277511679, 2.7401554006519815, 3.1047781028172268, 3.4855719900374074, 3.638543732502515, 4.200451797789798, 4.484040814562983, 4.551598086748091, 5.103894282691296, 5.150687088336425, 5.293180691744384]
mean5= [0.05212666666666667, 0.06093333333333333, 0.06721, 0.08015333333333333, 0.09875, 0.11853333333333334, 0.18156333333333333, 0.2917, 0.46853333333333336, 0.67866, 0.8862766666666667, 1.2600066666666667, 1.5659733333333334, 1.9570366666666668, 2.3505766666666665, 2.849336666666667, 3.30722, 3.6757733333333333, 4.21866, 4.717233333333334]
std5= [0.23394332067594684, 0.2519929805018826, 0.26360225574401547, 0.2863484645594517, 0.3159194583539714, 0.3441266950154001, 0.41218695918505505, 0.49649213823920046, 0.5776185438697603, 0.6268444286530218, 0.7000121452200352, 0.8540393433300103, 0.9613709928823292, 1.1326918462916362, 1.2787178477374208, 1.4583017154629634, 1.6525583817019396, 1.7838508164330584, 2.025920647771444, 2.272868161352279]
mean15= [0.05290333333333333, 0.08069, 0.19353666666666666, 0.6762733333333333, 1.5844266666666666, 2.7468433333333335, 4.26066, 5.611603333333333, 6.323573333333333, 7.426423333333333, 8.05433, 8.78093, 9.30252, 9.42401, 9.99978, 10.113323333333334, 10.772383333333334, 10.667013333333333, 11.13334, 11.223733333333334]
std15= [0.23582034967793222, 0.2883847960046901, 0.42266640745260187, 0.6367058807818742, 0.9694837825473009, 1.4207304584105866, 2.0466874939114015, 2.617450036961334, 2.913274268691883, 3.546821084782196, 3.897442526978429, 4.417763197414879, 4.806916716177498, 4.855983132854424, 5.294188003675982, 5.405632354818033, 5.974753606054023, 5.882757846437521, 6.330268591805565, 6.4109039972707595]
mean7= [0.051796666666666664, 0.06535666666666666, 0.07429, 0.09490666666666667, 0.16212666666666667, 0.29618333333333335, 0.5492366666666667, 0.8793566666666667, 1.27946, 1.76604, 2.339863333333333, 2.971276666666667, 3.6210533333333332, 4.20735, 4.930223333333333, 5.45199, 5.92267, 6.439996666666667, 6.92094, 7.254983333333334]
std7= [0.23306745516170968, 0.2619767918262142, 0.2767989569464933, 0.3104073527193295, 0.392260471229117, 0.4980148254709782, 0.5940839592646443, 0.696947046856662, 0.8552711704872711, 1.0395396665832428, 1.2537688176011113, 1.521533755827396, 1.764563994444205, 1.9976058947733741, 2.322709886487955, 2.5595224241838554, 2.7383906595723944, 3.0283350100875928, 3.2733911340382167, 3.426064822268967]
mean19= [0.053086666666666664, 0.09021, 0.4390966666666667, 1.3493866666666667, 2.97861, 4.617663333333334, 6.086366666666667, 7.2541633333333335, 8.1952, 9.088556666666667, 9.43749, 9.97827, 10.358463333333333, 10.594046666666667, 10.848836666666667, 11.18256, 11.43015, 11.66746, 11.68062, 12.136733333333334]
std19= [0.23678782166506976, 0.30428959216509527, 0.5640603844644846, 0.8802474787366461, 1.4654916585342046, 2.137506804664932, 2.8505076972746837, 3.4307352467542898, 4.010253976994475, 4.62976252632057, 4.891639040229768, 5.305737567994984, 5.6269779371632715, 5.828647232233413, 6.0639607227170895, 6.358666409953164, 6.607197664479247, 6.829996374942912, 6.850344741855453, 7.3189337107410815]
mean9= [0.052436666666666666, 0.06845, 0.09533, 0.15388666666666667, 0.29777333333333333, 0.68887, 1.18784, 1.7222266666666666, 2.591693333333333, 3.5300366666666667, 4.202683333333334, 5.03892, 5.489556666666667, 6.469233333333333, 6.81874, 7.39488, 7.954093333333334, 8.17351, 8.62648, 9.12125]
std9= [0.2352595644294947, 0.2668169113206033, 0.3118154225927041, 0.3851305758945774, 0.5033729981722191, 0.6292228988469295, 0.8438618376645945, 1.029431222547459, 1.3593867487298168, 1.7563915087442463, 2.0412584679690995, 2.3613834716679682, 2.5171871080213504, 3.0389548771832, 3.157463878769373, 3.5005232635897925, 3.870062778727096, 3.982648735021288, 4.292962008869867, 4.664739553733591]
mean13= [0.05246, 0.07177333333333333, 0.14542333333333332, 0.4365466666666667, 1.065, 1.9264933333333334, 2.9363133333333336, 4.26156, 5.471986666666667, 6.27626, 6.914126666666666, 7.910153333333334, 8.512966666666667, 8.562806666666667, 9.167963333333333, 9.742386666666667, 9.824553333333334, 10.12406, 10.45847, 10.58275]
std13= [0.23467981393095289, 0.2726204723705752, 0.37525376407913025, 0.5645709354505911, 0.7880831174438391, 1.106295667210574, 1.5205955001760185, 2.0733611278308466, 2.55675091730805, 2.9113079098118995, 3.2218492263432954, 3.8326693365271622, 4.251561893260196, 4.217508979159249, 4.632138993163837, 5.133572703665765, 5.1580246671720715, 5.416993241925511, 5.726022056579361, 5.814285204347995]
mean17= [0.05312, 0.08299333333333334, 0.21351, 1.0405866666666668, 2.07734, 3.7853, 5.194913333333333, 6.489773333333333, 7.506353333333333, 7.996896666666666, 8.767436666666667, 9.304753333333334, 10.028436666666666, 10.51746, 10.44703, 10.95374, 11.134113333333334, 11.453836666666668, 11.486996666666666, 11.825206666666666]
std17= [0.23676626786770114, 0.2922649025950411, 0.4414258864558504, 0.7755982996944286, 1.1508367351916893, 1.8943258897736333, 2.3991572393562612, 3.073351387105325, 3.578105593069544, 3.838151512901607, 4.3659589587308565, 4.765893278196184, 5.365362493748417, 5.8004478403309525, 5.696486125595322, 6.157908195624009, 6.290621613202378, 6.644832750339837, 6.686122761360943, 7.0097004660652615]
mean21= [0.05226666666666667, 0.10766, 0.5037766666666667, 1.83547, 3.57951, 5.448203333333334, 6.873043333333333, 7.8541533333333335, 9.047036666666667, 9.389086666666667, 10.258556666666667, 10.41625, 10.836943333333334, 11.02765, 11.359243333333334, 11.576, 11.862046666666666, 11.978026666666667, 12.22086, 12.149093333333333]
std21= [0.23446718794369126, 0.32821130043515157, 0.5837742744036908, 1.0782701636262904, 1.856745762501336, 2.5827202272001686, 3.2515942763700125, 3.7818269945211513, 4.633423236152965, 4.831349524976318, 5.560920048288373, 5.683361030602109, 6.044580701486985, 6.218151290978694, 6.536348692309457, 6.765982855432016, 7.062808851853646, 7.170281991615733, 7.406681276190212, 7.363333790565854]

fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(9, 2))
xs1 = np.linspace(0, 1, 100)
xs2 = np.linspace(0, 1, 20)
# marker_style = dict(color='cornflowerblue', markersize=3)
for pf, ys2, ys3 in zip(
    [factory(1), factory(3), factory(5), factory(9), factory(13), factory(17), factory(21)],
    [mean1, mean3, mean5, mean9, mean13, mean17, mean21],
    [std1, std3, std5, std9, std13, std17, std21]):
    ys1 = [pf(x) for x in xs1]
    ax1.plot(xs1, ys1)
    ax2.plot(xs2, ys2, marker='s', markersize=3)
    ax3.plot(xs2, ys3, marker='s', markersize=3)
ax1.tick_params(labelsize=8)
ax2.tick_params(labelsize=8)
ax3.tick_params(labelsize=8)

# ax.set_ylim(0, 1)
plt.savefig('nn_06.png')
plt.show()
